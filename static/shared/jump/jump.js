/*!
 * @license
 * Copyright 2019-2020 The Go Authors. All rights reserved.
 * Use of this source code is governed by a BSD-style
 * license that can be found in the LICENSE file.
 */
const jumpDialog = document.querySelector(".JumpDialog");
const jumpBody = jumpDialog?.querySelector(".JumpDialog-body");
const jumpList = jumpDialog?.querySelector(".JumpDialog-list");
const jumpFilter = jumpDialog?.querySelector(".JumpDialog-input");
const doc = document.querySelector(".js-documentation");
let jumpListItems;
function collectJumpListItems() {
  const items = [];
  if (!doc)
    return;
  for (const el of doc.querySelectorAll("[data-kind]")) {
    items.push(newJumpListItem(el));
  }
  for (const item of items) {
    item.link.addEventListener("click", function() {
      jumpDialog?.close();
    });
  }
  items.sort(function(a, b) {
    return a.lower.localeCompare(b.lower);
  });
  return items;
}
function newJumpListItem(el) {
  const a = document.createElement("a");
  const name = el.getAttribute("id");
  a.setAttribute("href", "#" + name);
  a.setAttribute("tabindex", "-1");
  a.setAttribute("data-gtmc", "jump to link");
  const kind = el.getAttribute("data-kind");
  return {
    link: a,
    name: name ?? "",
    kind: kind ?? "",
    lower: name?.toLowerCase() ?? ""
  };
}
let lastFilterValue;
let activeJumpItem = -1;
function updateJumpList(filter) {
  lastFilterValue = filter;
  if (!jumpListItems) {
    jumpListItems = collectJumpListItems();
  }
  setActiveJumpItem(-1);
  while (jumpList?.firstChild) {
    jumpList.firstChild.remove();
  }
  if (filter) {
    const filterLowerCase = filter.toLowerCase();
    const exactMatches = [];
    const prefixMatches = [];
    const infixMatches = [];
    const makeLinkHtml = (item, boldStart, boldEnd) => {
      return item.name.substring(0, boldStart) + "<b>" + item.name.substring(boldStart, boldEnd) + "</b>" + item.name.substring(boldEnd);
    };
    for (const item of jumpListItems ?? []) {
      const nameLowerCase = item.name.toLowerCase();
      if (nameLowerCase === filterLowerCase) {
        item.link.innerHTML = makeLinkHtml(item, 0, item.name.length);
        exactMatches.push(item);
      } else if (nameLowerCase.startsWith(filterLowerCase)) {
        item.link.innerHTML = makeLinkHtml(item, 0, filter.length);
        prefixMatches.push(item);
      } else {
        const index = nameLowerCase.indexOf(filterLowerCase);
        if (index > -1) {
          item.link.innerHTML = makeLinkHtml(item, index, index + filter.length);
          infixMatches.push(item);
        }
      }
    }
    for (const item of exactMatches.concat(prefixMatches).concat(infixMatches)) {
      jumpList?.appendChild(item.link);
    }
  } else {
    if (!jumpListItems || jumpListItems.length === 0) {
      const msg = document.createElement("i");
      msg.innerHTML = "There are no identifiers on this page.";
      jumpList?.appendChild(msg);
    }
    for (const item of jumpListItems ?? []) {
      item.link.innerHTML = item.name + " <i>" + item.kind + "</i>";
      jumpList?.appendChild(item.link);
    }
  }
  if (jumpBody) {
    jumpBody.scrollTop = 0;
  }
  if (jumpListItems?.length && jumpList && jumpList.children.length > 0) {
    setActiveJumpItem(0);
  }
}
function setActiveJumpItem(n) {
  const cs = jumpList?.children;
  if (!cs || !jumpBody) {
    return;
  }
  if (activeJumpItem >= 0) {
    cs[activeJumpItem].classList.remove("JumpDialog-active");
  }
  if (n >= cs.length) {
    n = cs.length - 1;
  }
  if (n >= 0) {
    cs[n].classList.add("JumpDialog-active");
    const activeTop = cs[n].offsetTop - cs[0].offsetTop;
    const activeBottom = activeTop + cs[n].clientHeight;
    if (activeTop < jumpBody.scrollTop) {
      jumpBody.scrollTop = activeTop;
    } else if (activeBottom > jumpBody.scrollTop + jumpBody.clientHeight) {
      jumpBody.scrollTop = activeBottom - jumpBody.clientHeight;
    }
  }
  activeJumpItem = n;
}
function incActiveJumpItem(delta) {
  if (activeJumpItem < 0) {
    return;
  }
  let n = activeJumpItem + delta;
  if (n < 0) {
    n = 0;
  }
  setActiveJumpItem(n);
}
jumpFilter?.addEventListener("keyup", function() {
  if (jumpFilter.value.toUpperCase() != lastFilterValue.toUpperCase()) {
    updateJumpList(jumpFilter.value);
  }
});
jumpFilter?.addEventListener("keydown", function(event) {
  const upArrow = 38;
  const downArrow = 40;
  const enterKey = 13;
  switch (event.which) {
    case upArrow:
      incActiveJumpItem(-1);
      event.preventDefault();
      break;
    case downArrow:
      incActiveJumpItem(1);
      event.preventDefault();
      break;
    case enterKey:
      if (activeJumpItem >= 0) {
        if (jumpList) {
          jumpList.children[activeJumpItem].click();
          event.preventDefault();
        }
      }
      break;
  }
});
const shortcutsDialog = document.querySelector(".ShortcutsDialog");
document.addEventListener("keypress", function(e) {
  if (jumpDialog?.open || shortcutsDialog?.open) {
    return;
  }
  const target = e.target;
  const t = target?.tagName;
  if (t == "INPUT" || t == "SELECT" || t == "TEXTAREA") {
    return;
  }
  if (target?.contentEditable == "true") {
    return;
  }
  if (e.metaKey || e.ctrlKey) {
    return;
  }
  const ch = String.fromCharCode(e.which);
  switch (ch) {
    case "f":
    case "F":
      e.preventDefault();
      if (jumpFilter) {
        jumpFilter.value = "";
      }
      jumpDialog?.showModal();
      jumpFilter?.focus();
      updateJumpList("");
      break;
    case "?":
      shortcutsDialog?.showModal();
      break;
  }
});
const jumpOutlineInput = document.querySelector(".js-jumpToInput");
if (jumpOutlineInput) {
  jumpOutlineInput.addEventListener("click", () => {
    if (jumpFilter) {
      jumpFilter.value = "";
    }
    updateJumpList("");
  });
}
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsianVtcC50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiLyohXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTktMjAyMCBUaGUgR28gQXV0aG9ycy4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqIFVzZSBvZiB0aGlzIHNvdXJjZSBjb2RlIGlzIGdvdmVybmVkIGJ5IGEgQlNELXN0eWxlXG4gKiBsaWNlbnNlIHRoYXQgY2FuIGJlIGZvdW5kIGluIHRoZSBMSUNFTlNFIGZpbGUuXG4gKi9cblxuLy8gVGhpcyBmaWxlIGltcGxlbWVudHMgdGhlIGJlaGF2aW9yIG9mIHRoZSBcImp1bXAgdG8gaWRlbnRpZmVyXCIgZGlhbG9nIGZvciBHb1xuLy8gcGFja2FnZSBkb2N1bWVudGF0aW9uLCBhcyB3ZWxsIGFzIHRoZSBzaW1wbGUgZGlhbG9nIHRoYXQgZGlzcGxheXMga2V5Ym9hcmRcbi8vIHNob3J0Y3V0cy5cblxuLy8gVGhlIERPTSBmb3IgdGhlIGRpYWxvZ3MgaXMgYXQgdGhlIGJvdHRvbSBvZiBjb250ZW50L3N0YXRpYy9odG1sL3BhZ2VzL3BrZ19kb2MudG1wbC5cbi8vIFRoZSBDU1MgaXMgaW4gY29udGVudC9zdGF0aWMvY3NzL3N0eWxlc2hlZXQuY3NzLlxuXG4vLyBUaGUgZGlhbG9nIGlzIGFjdGl2YXRlZCBieSBwcmVzc2luZyB0aGUgJ2YnIGtleS4gSXQgcHJlc2VudHMgYSBsaXN0XG4vLyAoI0p1bXBEaWFsb2ctbGlzdCkgb2YgYWxsIEdvIGlkZW50aWZpZXJzIGRpc3BsYXllZCBpbiB0aGUgZG9jdW1lbnRhdGlvbi5cbi8vIEVudGVyaW5nIHRleHQgaW4gdGhlIGRpYWxvZydzIHRleHQgYm94ICgjSnVtcERpYWxvZy1maWx0ZXIpIHJlc3RyaWN0cyB0aGVcbi8vIGxpc3QgdG8gaWRlbnRpZmllcnMgY29udGFpbmluZyB0aGUgdGV4dC4gQ2xpY2tpbmcgb24gYW4gaWRlbnRpZmllciBqdW1wcyB0b1xuLy8gaXRzIGRvY3VtZW50YXRpb24uXG5cbi8vIFRoaXMgY29kZSBpcyBiYXNlZCBvblxuLy8gaHR0cHM6Ly9nby5nb29nbGVzb3VyY2UuY29tL2dkZG8vKy9yZWZzL2hlYWRzL21hc3Rlci9nZGRvLXNlcnZlci9hc3NldHMvc2l0ZS5qcy5cbi8vIEl0IHdhcyBtb2RpZmllZCB0byByZW1vdmUgdGhlIGRlcGVuZGVuY2Ugb24ganF1ZXJ5IGFuZCBib290c3RyYXAuXG5cbmNvbnN0IGp1bXBEaWFsb2cgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yPEhUTUxEaWFsb2dFbGVtZW50PignLkp1bXBEaWFsb2cnKTtcbmNvbnN0IGp1bXBCb2R5ID0ganVtcERpYWxvZz8ucXVlcnlTZWxlY3RvcjxIVE1MRGl2RWxlbWVudD4oJy5KdW1wRGlhbG9nLWJvZHknKTtcbmNvbnN0IGp1bXBMaXN0ID0ganVtcERpYWxvZz8ucXVlcnlTZWxlY3RvcjxIVE1MRGl2RWxlbWVudD4oJy5KdW1wRGlhbG9nLWxpc3QnKTtcbmNvbnN0IGp1bXBGaWx0ZXIgPSBqdW1wRGlhbG9nPy5xdWVyeVNlbGVjdG9yPEhUTUxJbnB1dEVsZW1lbnQ+KCcuSnVtcERpYWxvZy1pbnB1dCcpO1xuY29uc3QgZG9jID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcjxIVE1MRGl2RWxlbWVudD4oJy5qcy1kb2N1bWVudGF0aW9uJyk7XG5cbmludGVyZmFjZSBKdW1wTGlzdEl0ZW0ge1xuICBsaW5rOiBIVE1MQW5jaG9yRWxlbWVudDtcbiAgbmFtZTogc3RyaW5nO1xuICBraW5kOiBzdHJpbmc7XG4gIGxvd2VyOiBzdHJpbmc7XG59XG5cbmxldCBqdW1wTGlzdEl0ZW1zOiBKdW1wTGlzdEl0ZW1bXSB8IHVuZGVmaW5lZDsgLy8gQWxsIHRoZSBpZGVudGlmaWVycyBpbiB0aGUgZG9jOyBjb21wdXRlZCBvbmx5IG9uY2UuXG5cbi8vIGNvbGxlY3RKdW1wTGlzdEl0ZW1zIHJldHVybnMgYSBsaXN0IG9mIGl0ZW1zLCBvbmUgZm9yIGVhY2ggaWRlbnRpZmllciBpbiB0aGVcbi8vIGRvY3VtZW50YXRpb24gb24gdGhlIGN1cnJlbnQgcGFnZS5cbi8vXG4vLyBJdCB1c2VzIHRoZSBkYXRhLWtpbmQgYXR0cmlidXRlIGdlbmVyYXRlZCBpbiB0aGUgZG9jdW1lbnRhdGlvbiBIVE1MIHRvIGZpbmRcbi8vIHRoZSBpZGVudGlmaWVycyBhbmQgdGhlaXIgaWQgYXR0cmlidXRlcy5cbi8vXG4vLyBJZiB0aGVyZSBhcmUgbm8gZGF0YS1raW5kIGF0dHJpYnV0ZXMsIHRoZW4gd2UgaGF2ZSBvbGRlciBkb2M7IGZhbGwgYmFjayB0b1xuLy8gYSBsZXNzIHByZWNpc2UgbWV0aG9kLlxuZnVuY3Rpb24gY29sbGVjdEp1bXBMaXN0SXRlbXMoKSB7XG4gIGNvbnN0IGl0ZW1zID0gW107XG4gIGlmICghZG9jKSByZXR1cm47XG4gIGZvciAoY29uc3QgZWwgb2YgZG9jLnF1ZXJ5U2VsZWN0b3JBbGwoJ1tkYXRhLWtpbmRdJykpIHtcbiAgICBpdGVtcy5wdXNoKG5ld0p1bXBMaXN0SXRlbShlbCkpO1xuICB9XG5cbiAgLy8gQ2xpY2tpbmcgb24gYW55IG9mIHRoZSBsaW5rcyBjbG9zZXMgdGhlIGRpYWxvZy5cbiAgZm9yIChjb25zdCBpdGVtIG9mIGl0ZW1zKSB7XG4gICAgaXRlbS5saW5rLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICAganVtcERpYWxvZz8uY2xvc2UoKTtcbiAgICB9KTtcbiAgfVxuICAvLyBTb3J0IGNhc2UtaW5zZW5zaXRpdmVseSBieSBpZGVudGlmaWVyIG5hbWUuXG4gIGl0ZW1zLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHtcbiAgICByZXR1cm4gYS5sb3dlci5sb2NhbGVDb21wYXJlKGIubG93ZXIpO1xuICB9KTtcbiAgcmV0dXJuIGl0ZW1zO1xufVxuXG4vLyBuZXdKdW1wTGlzdEl0ZW0gY3JlYXRlcyBhIG5ldyBpdGVtIGZvciB0aGUgRE9NIGVsZW1lbnQgZWwuXG4vLyBBbiBpdGVtIGlzIGFuIG9iamVjdCB3aXRoOlxuLy8gLSBuYW1lOiB0aGUgZWxlbWVudCdzIGlkICh3aGljaCBpcyB0aGUgaWRlbnRpZmVyIG5hbWUpXG4vLyAtIGtpbmQ6IHRoZSBlbGVtZW50J3Mga2luZCAoZnVuY3Rpb24sIHZhcmlhYmxlLCBldGMuKSxcbi8vIC0gbGluazogYSBsaW5rICgnYScgdGFnKSB0byB0aGUgZWxlbWVudFxuLy8gLSBsb3dlcjogdGhlIG5hbWUgaW4gbG93ZXIgY2FzZSwganVzdCBmb3Igc29ydGluZ1xuZnVuY3Rpb24gbmV3SnVtcExpc3RJdGVtKGVsOiBFbGVtZW50KTogSnVtcExpc3RJdGVtIHtcbiAgY29uc3QgYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTtcbiAgY29uc3QgbmFtZSA9IGVsLmdldEF0dHJpYnV0ZSgnaWQnKTtcbiAgYS5zZXRBdHRyaWJ1dGUoJ2hyZWYnLCAnIycgKyBuYW1lKTtcbiAgYS5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywgJy0xJyk7XG4gIGEuc2V0QXR0cmlidXRlKCdkYXRhLWd0bWMnLCAnanVtcCB0byBsaW5rJyk7XG4gIGNvbnN0IGtpbmQgPSBlbC5nZXRBdHRyaWJ1dGUoJ2RhdGEta2luZCcpO1xuICByZXR1cm4ge1xuICAgIGxpbms6IGEsXG4gICAgbmFtZTogbmFtZSA/PyAnJyxcbiAgICBraW5kOiBraW5kID8/ICcnLFxuICAgIGxvd2VyOiBuYW1lPy50b0xvd2VyQ2FzZSgpID8/ICcnLCAvLyBmb3Igc29ydGluZ1xuICB9O1xufVxuXG5sZXQgbGFzdEZpbHRlclZhbHVlOiBzdHJpbmc7IC8vIFRoZSBsYXN0IGNvbnRlbnRzIG9mIHRoZSBmaWx0ZXIgdGV4dCBib3guXG5sZXQgYWN0aXZlSnVtcEl0ZW0gPSAtMTsgLy8gVGhlIGluZGV4IG9mIHRoZSBjdXJyZW50bHkgYWN0aXZlIGl0ZW0gaW4gdGhlIGxpc3QuXG5cbi8vIHVwZGF0ZUp1bXBMaXN0IHNldHMgdGhlIGVsZW1lbnRzIG9mIHRoZSBkaWFsb2cgbGlzdCB0b1xuLy8gZXZlcnl0aGluZyB3aG9zZSBuYW1lIGNvbnRhaW5zIGZpbHRlci5cbmZ1bmN0aW9uIHVwZGF0ZUp1bXBMaXN0KGZpbHRlcjogc3RyaW5nKSB7XG4gIGxhc3RGaWx0ZXJWYWx1ZSA9IGZpbHRlcjtcbiAgaWYgKCFqdW1wTGlzdEl0ZW1zKSB7XG4gICAganVtcExpc3RJdGVtcyA9IGNvbGxlY3RKdW1wTGlzdEl0ZW1zKCk7XG4gIH1cbiAgc2V0QWN0aXZlSnVtcEl0ZW0oLTEpO1xuXG4gIC8vIFJlbW92ZSBhbGwgY2hpbGRyZW4gZnJvbSBsaXN0LlxuICB3aGlsZSAoanVtcExpc3Q/LmZpcnN0Q2hpbGQpIHtcbiAgICBqdW1wTGlzdC5maXJzdENoaWxkLnJlbW92ZSgpO1xuICB9XG5cbiAgaWYgKGZpbHRlcikge1xuICAgIC8vIEEgZmlsdGVyIGlzIHNldC4gV2UgdHJlYXQgdGhlIGZpbHRlciBhcyBhIHN1YnN0cmluZyB0aGF0IGNhbiBhcHBlYXIgaW5cbiAgICAvLyBhbiBpdGVtIG5hbWUgKGNhc2UgaW5zZW5zaXRpdmUpLCBhbmQgZmluZCB0aGUgZm9sbG93aW5nIG1hdGNoZXMgLSBpblxuICAgIC8vIG9yZGVyIG9mIHByaW9yaXR5OlxuICAgIC8vXG4gICAgLy8gMS4gRXhhY3QgbWF0Y2hlcyAodGhlIGZpbHRlciBtYXRjaGVzIHRoZSBpdGVtJ3MgbmFtZSBleGFjdGx5KVxuICAgIC8vIDIuIFByZWZpeCBtYXRjaGVzICh0aGUgaXRlbSdzIG5hbWUgc3RhcnRzIHdpdGggZmlsdGVyKVxuICAgIC8vIDMuIEluZml4IG1hdGNoZXMgKHRoZSBmaWx0ZXIgaXMgYSBzdWJzdHJpbmcgb2YgdGhlIGl0ZW0ncyBuYW1lKVxuICAgIGNvbnN0IGZpbHRlckxvd2VyQ2FzZSA9IGZpbHRlci50b0xvd2VyQ2FzZSgpO1xuXG4gICAgY29uc3QgZXhhY3RNYXRjaGVzID0gW107XG4gICAgY29uc3QgcHJlZml4TWF0Y2hlcyA9IFtdO1xuICAgIGNvbnN0IGluZml4TWF0Y2hlcyA9IFtdO1xuXG4gICAgLy8gbWFrZUxpbmtIdG1sIGNyZWF0ZXMgdGhlIGxpbmsgbmFtZSBIVE1MIGZvciBhIGxpc3QgaXRlbS4gaXRlbSBpcyB0aGUgRE9NXG4gICAgLy8gaXRlbS4gaXRlbS5uYW1lLnN1YnN0cihib2xkU3RhcnQsIGJvbGRFbmQpIHdpbGwgYmUgYm9sZGVkLlxuICAgIGNvbnN0IG1ha2VMaW5rSHRtbCA9IChpdGVtOiBKdW1wTGlzdEl0ZW0sIGJvbGRTdGFydDogbnVtYmVyLCBib2xkRW5kOiBudW1iZXIpID0+IHtcbiAgICAgIHJldHVybiAoXG4gICAgICAgIGl0ZW0ubmFtZS5zdWJzdHJpbmcoMCwgYm9sZFN0YXJ0KSArXG4gICAgICAgICc8Yj4nICtcbiAgICAgICAgaXRlbS5uYW1lLnN1YnN0cmluZyhib2xkU3RhcnQsIGJvbGRFbmQpICtcbiAgICAgICAgJzwvYj4nICtcbiAgICAgICAgaXRlbS5uYW1lLnN1YnN0cmluZyhib2xkRW5kKVxuICAgICAgKTtcbiAgICB9O1xuXG4gICAgZm9yIChjb25zdCBpdGVtIG9mIGp1bXBMaXN0SXRlbXMgPz8gW10pIHtcbiAgICAgIGNvbnN0IG5hbWVMb3dlckNhc2UgPSBpdGVtLm5hbWUudG9Mb3dlckNhc2UoKTtcblxuICAgICAgaWYgKG5hbWVMb3dlckNhc2UgPT09IGZpbHRlckxvd2VyQ2FzZSkge1xuICAgICAgICBpdGVtLmxpbmsuaW5uZXJIVE1MID0gbWFrZUxpbmtIdG1sKGl0ZW0sIDAsIGl0ZW0ubmFtZS5sZW5ndGgpO1xuICAgICAgICBleGFjdE1hdGNoZXMucHVzaChpdGVtKTtcbiAgICAgIH0gZWxzZSBpZiAobmFtZUxvd2VyQ2FzZS5zdGFydHNXaXRoKGZpbHRlckxvd2VyQ2FzZSkpIHtcbiAgICAgICAgaXRlbS5saW5rLmlubmVySFRNTCA9IG1ha2VMaW5rSHRtbChpdGVtLCAwLCBmaWx0ZXIubGVuZ3RoKTtcbiAgICAgICAgcHJlZml4TWF0Y2hlcy5wdXNoKGl0ZW0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc3QgaW5kZXggPSBuYW1lTG93ZXJDYXNlLmluZGV4T2YoZmlsdGVyTG93ZXJDYXNlKTtcbiAgICAgICAgaWYgKGluZGV4ID4gLTEpIHtcbiAgICAgICAgICBpdGVtLmxpbmsuaW5uZXJIVE1MID0gbWFrZUxpbmtIdG1sKGl0ZW0sIGluZGV4LCBpbmRleCArIGZpbHRlci5sZW5ndGgpO1xuICAgICAgICAgIGluZml4TWF0Y2hlcy5wdXNoKGl0ZW0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgZm9yIChjb25zdCBpdGVtIG9mIGV4YWN0TWF0Y2hlcy5jb25jYXQocHJlZml4TWF0Y2hlcykuY29uY2F0KGluZml4TWF0Y2hlcykpIHtcbiAgICAgIGp1bXBMaXN0Py5hcHBlbmRDaGlsZChpdGVtLmxpbmspO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBpZiAoIWp1bXBMaXN0SXRlbXMgfHwganVtcExpc3RJdGVtcy5sZW5ndGggPT09IDApIHtcbiAgICAgIGNvbnN0IG1zZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2knKTtcbiAgICAgIG1zZy5pbm5lckhUTUwgPSAnVGhlcmUgYXJlIG5vIGlkZW50aWZpZXJzIG9uIHRoaXMgcGFnZS4nO1xuICAgICAganVtcExpc3Q/LmFwcGVuZENoaWxkKG1zZyk7XG4gICAgfVxuICAgIC8vIE5vIGZpbHRlciBzZXQ7IGRpc3BsYXkgYWxsIGl0ZW1zIGluIHRoZWlyIGV4aXN0aW5nIG9yZGVyLlxuICAgIGZvciAoY29uc3QgaXRlbSBvZiBqdW1wTGlzdEl0ZW1zID8/IFtdKSB7XG4gICAgICBpdGVtLmxpbmsuaW5uZXJIVE1MID0gaXRlbS5uYW1lICsgJyA8aT4nICsgaXRlbS5raW5kICsgJzwvaT4nO1xuICAgICAganVtcExpc3Q/LmFwcGVuZENoaWxkKGl0ZW0ubGluayk7XG4gICAgfVxuICB9XG5cbiAgaWYgKGp1bXBCb2R5KSB7XG4gICAganVtcEJvZHkuc2Nyb2xsVG9wID0gMDtcbiAgfVxuICBpZiAoanVtcExpc3RJdGVtcz8ubGVuZ3RoICYmIGp1bXBMaXN0ICYmIGp1bXBMaXN0LmNoaWxkcmVuLmxlbmd0aCA+IDApIHtcbiAgICBzZXRBY3RpdmVKdW1wSXRlbSgwKTtcbiAgfVxufVxuXG4vLyBTZXQgdGhlIGFjdGl2ZSBqdW1wIGl0ZW0gdG8gbi5cbmZ1bmN0aW9uIHNldEFjdGl2ZUp1bXBJdGVtKG46IG51bWJlcikge1xuICBjb25zdCBjcyA9IGp1bXBMaXN0Py5jaGlsZHJlbiBhcyBIVE1MQ29sbGVjdGlvbk9mPEhUTUxFbGVtZW50PiB8IG51bGwgfCB1bmRlZmluZWQ7XG4gIGlmICghY3MgfHwgIWp1bXBCb2R5KSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIGlmIChhY3RpdmVKdW1wSXRlbSA+PSAwKSB7XG4gICAgY3NbYWN0aXZlSnVtcEl0ZW1dLmNsYXNzTGlzdC5yZW1vdmUoJ0p1bXBEaWFsb2ctYWN0aXZlJyk7XG4gIH1cbiAgaWYgKG4gPj0gY3MubGVuZ3RoKSB7XG4gICAgbiA9IGNzLmxlbmd0aCAtIDE7XG4gIH1cbiAgaWYgKG4gPj0gMCkge1xuICAgIGNzW25dLmNsYXNzTGlzdC5hZGQoJ0p1bXBEaWFsb2ctYWN0aXZlJyk7XG5cbiAgICAvLyBTY3JvbGwgc28gdGhlIGFjdGl2ZSBpdGVtIGlzIHZpc2libGUuXG4gICAgLy8gRm9yIHNvbWUgcmVhc29uIGNzW25dLnNjcm9sbEludG9WaWV3KCkgZG9lc24ndCBiZWhhdmUgYXMgSSdkIGV4cGVjdDpcbiAgICAvLyBpdCBtb3ZlcyB0aGUgZW50aXJlIGRpYWxvZyBib3ggaW4gdGhlIHZpZXdwb3J0LlxuXG4gICAgLy8gR2V0IHRoZSB0b3AgYW5kIGJvdHRvbSBvZiB0aGUgYWN0aXZlIGl0ZW0gcmVsYXRpdmUgdG8ganVtcEJvZHkuXG4gICAgY29uc3QgYWN0aXZlVG9wID0gY3Nbbl0ub2Zmc2V0VG9wIC0gY3NbMF0ub2Zmc2V0VG9wO1xuICAgIGNvbnN0IGFjdGl2ZUJvdHRvbSA9IGFjdGl2ZVRvcCArIGNzW25dLmNsaWVudEhlaWdodDtcbiAgICBpZiAoYWN0aXZlVG9wIDwganVtcEJvZHkuc2Nyb2xsVG9wKSB7XG4gICAgICAvLyBPZmYgdGhlIHRvcDsgc2Nyb2xsIHVwLlxuICAgICAganVtcEJvZHkuc2Nyb2xsVG9wID0gYWN0aXZlVG9wO1xuICAgIH0gZWxzZSBpZiAoYWN0aXZlQm90dG9tID4ganVtcEJvZHkuc2Nyb2xsVG9wICsganVtcEJvZHkuY2xpZW50SGVpZ2h0KSB7XG4gICAgICAvLyBPZmYgdGhlIGJvdHRvbTsgc2Nyb2xsIGRvd24uXG4gICAgICBqdW1wQm9keS5zY3JvbGxUb3AgPSBhY3RpdmVCb3R0b20gLSBqdW1wQm9keS5jbGllbnRIZWlnaHQ7XG4gICAgfVxuICB9XG4gIGFjdGl2ZUp1bXBJdGVtID0gbjtcbn1cblxuLy8gSW5jcmVtZW50IHRoZSBhY3RpdmVKdW1wSXRlbSBieSBkZWx0YS5cbmZ1bmN0aW9uIGluY0FjdGl2ZUp1bXBJdGVtKGRlbHRhOiBudW1iZXIpIHtcbiAgaWYgKGFjdGl2ZUp1bXBJdGVtIDwgMCkge1xuICAgIHJldHVybjtcbiAgfVxuICBsZXQgbiA9IGFjdGl2ZUp1bXBJdGVtICsgZGVsdGE7XG4gIGlmIChuIDwgMCkge1xuICAgIG4gPSAwO1xuICB9XG4gIHNldEFjdGl2ZUp1bXBJdGVtKG4pO1xufVxuXG4vLyBQcmVzc2luZyBhIGtleSBpbiB0aGUgZmlsdGVyIHVwZGF0ZXMgdGhlIGxpc3QgKGlmIHRoZSBmaWx0ZXIgYWN0dWFsbHkgY2hhbmdlZCkuXG5qdW1wRmlsdGVyPy5hZGRFdmVudExpc3RlbmVyKCdrZXl1cCcsIGZ1bmN0aW9uICgpIHtcbiAgaWYgKGp1bXBGaWx0ZXIudmFsdWUudG9VcHBlckNhc2UoKSAhPSBsYXN0RmlsdGVyVmFsdWUudG9VcHBlckNhc2UoKSkge1xuICAgIHVwZGF0ZUp1bXBMaXN0KGp1bXBGaWx0ZXIudmFsdWUpO1xuICB9XG59KTtcblxuLy8gUHJlc3NpbmcgZW50ZXIgaW4gdGhlIGZpbHRlciBzZWxlY3RzIHRoZSBmaXJzdCBlbGVtZW50IGluIHRoZSBsaXN0LlxuanVtcEZpbHRlcj8uYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGZ1bmN0aW9uIChldmVudCkge1xuICBjb25zdCB1cEFycm93ID0gMzg7XG4gIGNvbnN0IGRvd25BcnJvdyA9IDQwO1xuICBjb25zdCBlbnRlcktleSA9IDEzO1xuICBzd2l0Y2ggKGV2ZW50LndoaWNoKSB7XG4gICAgY2FzZSB1cEFycm93OlxuICAgICAgaW5jQWN0aXZlSnVtcEl0ZW0oLTEpO1xuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgZG93bkFycm93OlxuICAgICAgaW5jQWN0aXZlSnVtcEl0ZW0oMSk7XG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSBlbnRlcktleTpcbiAgICAgIGlmIChhY3RpdmVKdW1wSXRlbSA+PSAwKSB7XG4gICAgICAgIGlmIChqdW1wTGlzdCkge1xuICAgICAgICAgIChqdW1wTGlzdC5jaGlsZHJlblthY3RpdmVKdW1wSXRlbV0gYXMgSFRNTEVsZW1lbnQpLmNsaWNrKCk7XG4gICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgYnJlYWs7XG4gIH1cbn0pO1xuXG5jb25zdCBzaG9ydGN1dHNEaWFsb2cgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yPEhUTUxEaWFsb2dFbGVtZW50PignLlNob3J0Y3V0c0RpYWxvZycpO1xuXG4vLyBLZXlib2FyZCBzaG9ydGN1dHM6XG4vLyAtIFByZXNzaW5nICcvJyBmb2N1c2VzIHRoZSBzZWFyY2ggYm94XG4vLyAtIFByZXNzaW5nICdmJyBvciAnRicgb3BlbnMgdGhlIGp1bXAtdG8taWRlbnRpZmllciBkaWFsb2cuXG4vLyAtIFByZXNzaW5nICc/JyBvcGVucyB1cCB0aGUgc2hvcnRjdXQgZGlhbG9nLlxuLy8gSWdub3JlIGEga2V5cHJlc3MgaWYgYSBkaWFsb2cgaXMgYWxyZWFkeSBvcGVuLCBvciBpZiBpdCBpcyBwcmVzc2VkIG9uIGFcbi8vIGNvbXBvbmVudCB0aGF0IHdhbnRzIHRvIGNvbnN1bWUgaXQuXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlwcmVzcycsIGZ1bmN0aW9uIChlKSB7XG4gIGlmIChqdW1wRGlhbG9nPy5vcGVuIHx8IHNob3J0Y3V0c0RpYWxvZz8ub3Blbikge1xuICAgIHJldHVybjtcbiAgfVxuICBjb25zdCB0YXJnZXQgPSBlLnRhcmdldCBhcyBIVE1MRWxlbWVudCB8IG51bGw7XG4gIGNvbnN0IHQgPSB0YXJnZXQ/LnRhZ05hbWU7XG4gIGlmICh0ID09ICdJTlBVVCcgfHwgdCA9PSAnU0VMRUNUJyB8fCB0ID09ICdURVhUQVJFQScpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgaWYgKHRhcmdldD8uY29udGVudEVkaXRhYmxlID09ICd0cnVlJykge1xuICAgIHJldHVybjtcbiAgfVxuICBpZiAoZS5tZXRhS2V5IHx8IGUuY3RybEtleSkge1xuICAgIHJldHVybjtcbiAgfVxuICBjb25zdCBjaCA9IFN0cmluZy5mcm9tQ2hhckNvZGUoZS53aGljaCk7XG4gIHN3aXRjaCAoY2gpIHtcbiAgICBjYXNlICdmJzpcbiAgICBjYXNlICdGJzpcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIGlmIChqdW1wRmlsdGVyKSB7XG4gICAgICAgIGp1bXBGaWx0ZXIudmFsdWUgPSAnJztcbiAgICAgIH1cbiAgICAgIGp1bXBEaWFsb2c/LnNob3dNb2RhbCgpO1xuICAgICAganVtcEZpbHRlcj8uZm9jdXMoKTtcbiAgICAgIHVwZGF0ZUp1bXBMaXN0KCcnKTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgJz8nOlxuICAgICAgc2hvcnRjdXRzRGlhbG9nPy5zaG93TW9kYWwoKTtcbiAgICAgIGJyZWFrO1xuICB9XG59KTtcblxuY29uc3QganVtcE91dGxpbmVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5qcy1qdW1wVG9JbnB1dCcpO1xuaWYgKGp1bXBPdXRsaW5lSW5wdXQpIHtcbiAganVtcE91dGxpbmVJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICBpZiAoanVtcEZpbHRlcikge1xuICAgICAganVtcEZpbHRlci52YWx1ZSA9ICcnO1xuICAgIH1cbiAgICB1cGRhdGVKdW1wTGlzdCgnJyk7XG4gIH0pO1xufVxuIl0sCiAgIm1hcHBpbmdzIjogIkFBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBd0JBLE1BQU0sYUFBYSxTQUFTLGNBQWlDO0FBQzdELE1BQU0sV0FBVyxZQUFZLGNBQThCO0FBQzNELE1BQU0sV0FBVyxZQUFZLGNBQThCO0FBQzNELE1BQU0sYUFBYSxZQUFZLGNBQWdDO0FBQy9ELE1BQU0sTUFBTSxTQUFTLGNBQThCO0FBU25ELElBQUk7QUFVSixnQ0FBZ0M7QUFDOUIsUUFBTSxRQUFRO0FBQ2QsTUFBSSxDQUFDO0FBQUs7QUFDVixhQUFXLE1BQU0sSUFBSSxpQkFBaUIsZ0JBQWdCO0FBQ3BELFVBQU0sS0FBSyxnQkFBZ0I7QUFBQTtBQUk3QixhQUFXLFFBQVEsT0FBTztBQUN4QixTQUFLLEtBQUssaUJBQWlCLFNBQVMsV0FBWTtBQUM5QyxrQkFBWTtBQUFBO0FBQUE7QUFJaEIsUUFBTSxLQUFLLFNBQVUsR0FBRyxHQUFHO0FBQ3pCLFdBQU8sRUFBRSxNQUFNLGNBQWMsRUFBRTtBQUFBO0FBRWpDLFNBQU87QUFBQTtBQVNULHlCQUF5QixJQUEyQjtBQUNsRCxRQUFNLElBQUksU0FBUyxjQUFjO0FBQ2pDLFFBQU0sT0FBTyxHQUFHLGFBQWE7QUFDN0IsSUFBRSxhQUFhLFFBQVEsTUFBTTtBQUM3QixJQUFFLGFBQWEsWUFBWTtBQUMzQixJQUFFLGFBQWEsYUFBYTtBQUM1QixRQUFNLE9BQU8sR0FBRyxhQUFhO0FBQzdCLFNBQU87QUFBQSxJQUNMLE1BQU07QUFBQSxJQUNOLE1BQU0sUUFBUTtBQUFBLElBQ2QsTUFBTSxRQUFRO0FBQUEsSUFDZCxPQUFPLE1BQU0saUJBQWlCO0FBQUE7QUFBQTtBQUlsQyxJQUFJO0FBQ0osSUFBSSxpQkFBaUI7QUFJckIsd0JBQXdCLFFBQWdCO0FBQ3RDLG9CQUFrQjtBQUNsQixNQUFJLENBQUMsZUFBZTtBQUNsQixvQkFBZ0I7QUFBQTtBQUVsQixvQkFBa0I7QUFHbEIsU0FBTyxVQUFVLFlBQVk7QUFDM0IsYUFBUyxXQUFXO0FBQUE7QUFHdEIsTUFBSSxRQUFRO0FBUVYsVUFBTSxrQkFBa0IsT0FBTztBQUUvQixVQUFNLGVBQWU7QUFDckIsVUFBTSxnQkFBZ0I7QUFDdEIsVUFBTSxlQUFlO0FBSXJCLFVBQU0sZUFBZSxDQUFDLE1BQW9CLFdBQW1CLFlBQW9CO0FBQy9FLGFBQ0UsS0FBSyxLQUFLLFVBQVUsR0FBRyxhQUN2QixRQUNBLEtBQUssS0FBSyxVQUFVLFdBQVcsV0FDL0IsU0FDQSxLQUFLLEtBQUssVUFBVTtBQUFBO0FBSXhCLGVBQVcsUUFBUSxpQkFBaUIsSUFBSTtBQUN0QyxZQUFNLGdCQUFnQixLQUFLLEtBQUs7QUFFaEMsVUFBSSxrQkFBa0IsaUJBQWlCO0FBQ3JDLGFBQUssS0FBSyxZQUFZLGFBQWEsTUFBTSxHQUFHLEtBQUssS0FBSztBQUN0RCxxQkFBYSxLQUFLO0FBQUEsaUJBQ1QsY0FBYyxXQUFXLGtCQUFrQjtBQUNwRCxhQUFLLEtBQUssWUFBWSxhQUFhLE1BQU0sR0FBRyxPQUFPO0FBQ25ELHNCQUFjLEtBQUs7QUFBQSxhQUNkO0FBQ0wsY0FBTSxRQUFRLGNBQWMsUUFBUTtBQUNwQyxZQUFJLFFBQVEsSUFBSTtBQUNkLGVBQUssS0FBSyxZQUFZLGFBQWEsTUFBTSxPQUFPLFFBQVEsT0FBTztBQUMvRCx1QkFBYSxLQUFLO0FBQUE7QUFBQTtBQUFBO0FBS3hCLGVBQVcsUUFBUSxhQUFhLE9BQU8sZUFBZSxPQUFPLGVBQWU7QUFDMUUsZ0JBQVUsWUFBWSxLQUFLO0FBQUE7QUFBQSxTQUV4QjtBQUNMLFFBQUksQ0FBQyxpQkFBaUIsY0FBYyxXQUFXLEdBQUc7QUFDaEQsWUFBTSxNQUFNLFNBQVMsY0FBYztBQUNuQyxVQUFJLFlBQVk7QUFDaEIsZ0JBQVUsWUFBWTtBQUFBO0FBR3hCLGVBQVcsUUFBUSxpQkFBaUIsSUFBSTtBQUN0QyxXQUFLLEtBQUssWUFBWSxLQUFLLE9BQU8sU0FBUyxLQUFLLE9BQU87QUFDdkQsZ0JBQVUsWUFBWSxLQUFLO0FBQUE7QUFBQTtBQUkvQixNQUFJLFVBQVU7QUFDWixhQUFTLFlBQVk7QUFBQTtBQUV2QixNQUFJLGVBQWUsVUFBVSxZQUFZLFNBQVMsU0FBUyxTQUFTLEdBQUc7QUFDckUsc0JBQWtCO0FBQUE7QUFBQTtBQUt0QiwyQkFBMkIsR0FBVztBQUNwQyxRQUFNLEtBQUssVUFBVTtBQUNyQixNQUFJLENBQUMsTUFBTSxDQUFDLFVBQVU7QUFDcEI7QUFBQTtBQUVGLE1BQUksa0JBQWtCLEdBQUc7QUFDdkIsT0FBRyxnQkFBZ0IsVUFBVSxPQUFPO0FBQUE7QUFFdEMsTUFBSSxLQUFLLEdBQUcsUUFBUTtBQUNsQixRQUFJLEdBQUcsU0FBUztBQUFBO0FBRWxCLE1BQUksS0FBSyxHQUFHO0FBQ1YsT0FBRyxHQUFHLFVBQVUsSUFBSTtBQU9wQixVQUFNLFlBQVksR0FBRyxHQUFHLFlBQVksR0FBRyxHQUFHO0FBQzFDLFVBQU0sZUFBZSxZQUFZLEdBQUcsR0FBRztBQUN2QyxRQUFJLFlBQVksU0FBUyxXQUFXO0FBRWxDLGVBQVMsWUFBWTtBQUFBLGVBQ1osZUFBZSxTQUFTLFlBQVksU0FBUyxjQUFjO0FBRXBFLGVBQVMsWUFBWSxlQUFlLFNBQVM7QUFBQTtBQUFBO0FBR2pELG1CQUFpQjtBQUFBO0FBSW5CLDJCQUEyQixPQUFlO0FBQ3hDLE1BQUksaUJBQWlCLEdBQUc7QUFDdEI7QUFBQTtBQUVGLE1BQUksSUFBSSxpQkFBaUI7QUFDekIsTUFBSSxJQUFJLEdBQUc7QUFDVCxRQUFJO0FBQUE7QUFFTixvQkFBa0I7QUFBQTtBQUlwQixZQUFZLGlCQUFpQixTQUFTLFdBQVk7QUFDaEQsTUFBSSxXQUFXLE1BQU0saUJBQWlCLGdCQUFnQixlQUFlO0FBQ25FLG1CQUFlLFdBQVc7QUFBQTtBQUFBO0FBSzlCLFlBQVksaUJBQWlCLFdBQVcsU0FBVSxPQUFPO0FBQ3ZELFFBQU0sVUFBVTtBQUNoQixRQUFNLFlBQVk7QUFDbEIsUUFBTSxXQUFXO0FBQ2pCLFVBQVEsTUFBTTtBQUFBLFNBQ1A7QUFDSCx3QkFBa0I7QUFDbEIsWUFBTTtBQUNOO0FBQUEsU0FDRztBQUNILHdCQUFrQjtBQUNsQixZQUFNO0FBQ047QUFBQSxTQUNHO0FBQ0gsVUFBSSxrQkFBa0IsR0FBRztBQUN2QixZQUFJLFVBQVU7QUFDWixVQUFDLFNBQVMsU0FBUyxnQkFBZ0M7QUFDbkQsZ0JBQU07QUFBQTtBQUFBO0FBR1Y7QUFBQTtBQUFBO0FBSU4sTUFBTSxrQkFBa0IsU0FBUyxjQUFpQztBQVFsRSxTQUFTLGlCQUFpQixZQUFZLFNBQVUsR0FBRztBQUNqRCxNQUFJLFlBQVksUUFBUSxpQkFBaUIsTUFBTTtBQUM3QztBQUFBO0FBRUYsUUFBTSxTQUFTLEVBQUU7QUFDakIsUUFBTSxJQUFJLFFBQVE7QUFDbEIsTUFBSSxLQUFLLFdBQVcsS0FBSyxZQUFZLEtBQUssWUFBWTtBQUNwRDtBQUFBO0FBRUYsTUFBSSxRQUFRLG1CQUFtQixRQUFRO0FBQ3JDO0FBQUE7QUFFRixNQUFJLEVBQUUsV0FBVyxFQUFFLFNBQVM7QUFDMUI7QUFBQTtBQUVGLFFBQU0sS0FBSyxPQUFPLGFBQWEsRUFBRTtBQUNqQyxVQUFRO0FBQUEsU0FDRDtBQUFBLFNBQ0E7QUFDSCxRQUFFO0FBQ0YsVUFBSSxZQUFZO0FBQ2QsbUJBQVcsUUFBUTtBQUFBO0FBRXJCLGtCQUFZO0FBQ1osa0JBQVk7QUFDWixxQkFBZTtBQUNmO0FBQUEsU0FDRztBQUNILHVCQUFpQjtBQUNqQjtBQUFBO0FBQUE7QUFJTixNQUFNLG1CQUFtQixTQUFTLGNBQWM7QUFDaEQsSUFBSSxrQkFBa0I7QUFDcEIsbUJBQWlCLGlCQUFpQixTQUFTLE1BQU07QUFDL0MsUUFBSSxZQUFZO0FBQ2QsaUJBQVcsUUFBUTtBQUFBO0FBRXJCLG1CQUFlO0FBQUE7QUFBQTsiLAogICJuYW1lcyI6IFtdCn0K
