<!--
  Copyright 2020 The Go Authors. All rights reserved.
  Use of this source code is governed by a BSD-style
  license that can be found in the LICENSE file.
-->

{{define "unit_outline"}}
  <div class="UnitOutline">
    <div class="UnitOutline-jumpTo">
      <button class="UnitOutline-jumpToInput js-jumpToInput"
          aria-label="Open Jump to Identifier"
          data-test-id="jump-to-button" data-gtmc="outline button">
        Jump to ...
      </button>
    </div>
    <ul class="js-tree" role="tree" aria-label="Outline">
      {{if .Readme.String}}
        <li role="none" class="js-readmeOutline">
          <a href="#section-readme" role="treeitem" aria-expanded="false" aria-selected="false"
              aria-level="1" aria-owns="readme-outline" tabindex="0" data-gtmc="outline link">
            README
          </a>
          {{template "readme_outline" .ReadmeOutline}}
        </li>
      {{end}}
      {{if .IsPackage}}
        <li role="none">
          <a href="#section-documentation" role="treeitem" aria-expanded="false" aria-level="1"
              aria-selected="false"aria-owns="doc-outline" tabindex="-1" data-gtmc="outline link">
            Documentation
          </a>
          {{.DocOutline}}
        </li>
      {{end}}
      {{if .SourceFiles}}
        <li role="none">
          <a href="#section-sourcefiles" role="treeitem" aria-expanded="false"
              aria-selected="false" aria-level="1" tabindex="-1" data-gtmc="outline link">
            Source Files
          </a>
        </li>
      {{end}}
      {{if .Directories}}
        <li role="none">
          <a href="#section-directories" role="treeitem" aria-expanded="false"
              aria-selected="false" aria-level="1" tabindex="-1"
              data-gtmc="outline link">
            Directories
          </a>
        </li>
      {{end}}
    </ul>
  </div>
{{end}}

{{define "readme_outline"}}
  <ul role="group" id="readme-outline">
    {{range .}}
      <li role="none">
        <a href="#{{.ID}}" role="treeitem" aria-level="2" aria-owns="nav-group-readme"
            tabindex="-1" {{if gt (len .Children) 0}}aria-expanded="false"{{end}}
            data-gtmc="readme outline link">
          {{.Text}}
        </a>
        <ul role="group" id="nav-group-readme">
          {{range .Children}}
            {{$tname := .Text}}
            <li role="none">
              {{if .Children}}
                {{$navgroupid := (printf "nav.group.%s" $tname)}}
                <a href="#{{.ID}}" role="treeitem" aria-expanded="false" aria-level="3"
                    tabindex="-1" data-aria-owns="{{$navgroupid}}"
                    data-gtmc="readme outline link">
                  {{$tname}}
                </a>
                <ul role="group" >
                  {{range .Children}}
                    <li role="none">
                      <a href="#{{.ID}}" role="treeitem" aria-level="4" tabindex="-1"
                          data-gtmc="readme outline link">
                        {{.Text}}
                      </a>
                    </li>
                  {{end}} {{/* range .Children */}}
                </ul>
              {{else}}
                <a href="#{{.ID}}" role="treeitem" aria-level="3" tabindex="-1"
                    data-gtmc="readme outline link">
                  {{$tname}}
                </a>
              {{end}} {{/* if .Children */}}
            </li>
          {{end}} {{/* range .Children */}}
        </ul>
      </li>
    {{end}}
  </ul>
{{end}}

{{define "unit_outline_mobile"}}
  <nav class="DocNavMobile js-mobileNav">
    <label for="DocNavMobile-select" class="DocNavMobile-label">
      <svg class="DocNavMobile-selectIcon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="black" width="18px" height="18px">
        <path d="M0 0h24v24H0z" fill="none"/><path d="M3 9h14V7H3v2zm0 4h14v-2H3v2zm0 4h14v-2H3v2zm16 0h2v-2h-2v2zm0-10v2h2V7h-2zm0 6h2v-2h-2v2z"/>
      </svg>
      <span class="DocNavMobile-selectText js-mobileNavSelectText">Outline</span>
    </label>
    <select id="DocNavMobile-select" class="DocNavMobile-select">
      <option value="">Outline</option>
      <optgroup label="README">
        {{range .ReadmeOutline}}<option value="{{.ID}}">{{.Text}}</option>{{end}}
      </optgroup>
      {{.MobileOutline}}
      <option class="js-sourcefilesOption" value="section-sourcefiles">Source Files</option>
      <option class="js-directoriesOption" value="section-directories">Directories</option>
    </select>
  </nav>
{{end}}
